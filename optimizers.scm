(define (make-sgd-optimizer lr module)
  (let ((params (module:get-params module)))
    (lambda ()
      (letrec ((loop (lambda (i)
		       (if (< i (length params))
			   (let ((param (list-ref params i)))
			     (param:set-weight! param (- (param:get-weight param) (* lr (param:get-grad param))))
			     (loop (+ i 1)))))))
	(loop 0)))))
